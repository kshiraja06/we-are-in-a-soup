/*! gif.js 0.2.0 - https://github.com/jnordberg/gif.js */
(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.GifWorker = f()}})(function(){var define,module,exports;return (function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){"use strict";var BitArray=function(e){this.byteArray=new Uint8Array(e)};BitArray.prototype.index=function(e){return Math.floor(e/8)},BitArray.prototype.remainder=function(e){return 7-e%8},BitArray.prototype.push=function(e,t){for(var r=0;r<t;r++){var a=this.index(this.length);this.byteArray[a]|=((e>>>r&1)<<this.remainder(this.length)),this.length++}},BitArray.prototype.index=function(e){return Math.floor(e/8)},BitArray.prototype.remainder=function(e){return 7-e%8},BitArray.prototype.toByteArray=function(){return this.byteArray},module.exports=BitArray},{}],2:[function(require,module,exports){"use strict";var BitArray=require("./BitArray");module.exports=function(e){this.width=e.width,this.height=e.height,this.bitArray=new BitArray(e.width*e.height),this.pixelArray=new Uint8ClampedArray(e.width*e.height*4)};var GifIter=function(e){this.width=e.width,this.height=e.height,this.index=0};GifIter.prototype.next=function(){if(this.index>=this.width*this.height)throw StopIteration;var e=this.index;this.index++;return e},GifIter.prototype[Symbol.iterator]=function(){return this},module.exports.GifIter=GifIter},{"./BitArray":1}},{}],3:[function(require,module,exports){"use strict";var BitArray=require("./BitArray");module.exports=function(e){var t=e.img,r=t.length,i=e.dict;(e.clearCode||(e.clearCode=Math.max(2,i)),e.eoiCode||(e.eoiCode=e.clearCode+1),e.nextCode||(e.nextCode=e.eoiCode+1),e.codeSize||(e.codeSize=3),e.bitArray||(e.bitArray=new BitArray(r))),this.bitArray=e.bitArray,this.img=t,this.dict=i,this.clearCode=e.clearCode,this.eoiCode=e.eoiCode,this.nextCode=e.nextCode,this.codeSize=e.codeSize,this.loop=0};var GifEncoderLZW=function(e){this.bitArray=e.bitArray,this.img=e.img,this.dict=e.dict,this.clearCode=e.clearCode,this.eoiCode=e.eoiCode,this.nextCode=e.nextCode,this.codeSize=e.codeSize,this.loop=0};GifEncoderLZW.prototype.encode=function(){this.bitArray.push(this.clearCode,this.codeSize);for(var e,t,r="",i=0;i<this.img.length;i++)e=this.img[i],t=r+String.fromCharCode(e),this.dict[t]||(this.bitArray.push(this.dict[r],this.codeSize),this.nextCode===1<<this.codeSize&&(this.bitArray.push(this.eoiCode,this.codeSize),this.codeSize++),this.dict[t]=this.nextCode++,r=String.fromCharCode(e)),r.length&&this.bitArray.push(this.dict[r],this.codeSize),this.bitArray.push(this.eoiCode,this.codeSize)},module.exports=GifEncoderLZW},{"./BitArray":1}},{}],4:[function(require,module,exports){"use strict";var BitArray=require("./BitArray"),GifEncoderLZW=require("./GifEncoderLZW");module.exports=function(e){this.width=e.width,this.height=e.height,this.globalColorTable=e.globalColorTable,this.globalColorTableSize=e.globalColorTableSize||256,this.localColorTables=[],this.frames=[],this.buffer=[],this.loop=e.loop,this.disposalMethod=e.disposalMethod,this.delayTime=e.delayTime,this.transparentIndex=e.transparentIndex};var GifWriter=function(e){this.width=e.width,this.height=e.height,this.globalColorTable=e.globalColorTable,this.globalColorTableSize=e.globalColorTableSize||256,this.localColorTables=[],this.frames=[],this.buffer=[],this.loop=e.loop,this.disposalMethod=e.disposalMethod,this.delayTime=e.delayTime,this.transparentIndex=e.transparentIndex};GifWriter.prototype.addFrame=function(e,t){var r=new Uint8ClampedArray(e),i=t||{};this.frames.push(r),this.delayTime=i.delay,this.disposalMethod=i.disposal};var GifRenderer=function(e){var t=e.width,r=e.height;this.width=t,this.height=r,this.palette=[],this.buffer=[],this.transparentIndex=e.transparentIndex,this.globalColorTableSize=e.globalColorTableSize||256};GifRenderer.prototype.addFrame=function(e,t){var r=t||{};this.palette=e.palette,this.buffer=e.buffer};var BitWriter=function(e){this.bytes=[],this.size=0};BitWriter.prototype.writeBits=function(e,t){for(var r=0;r<t;r++)this.bytes.push((e>>>r&1)?128:0),this.size++;if(this.size%8==0){for(var i=0;i<this.bytes.length;i+=8){var n=0;for(var o in this.bytes.slice(i,i+8))n<<=1,n|=(this.bytes[o]>>7);this.bytes[i/8]=n}}};var ByteArrayWriter=function(e){this.buffer=[],this.position=0};ByteArrayWriter.prototype.writeByte=function(e){this.buffer.push(e&255)},ByteArrayWriter.prototype.writeUTFBytes=function(e){for(var t=0;t<e.length;t++)this.writeByte(e.charCodeAt(t))},ByteArrayWriter.prototype.writeBytes=function(e){this.buffer=this.buffer.concat(e)},module.exports=GifWriter,module.exports.GifRenderer=GifRenderer,module.exports.BitWriter=BitWriter,module.exports.ByteArrayWriter=ByteArrayWriter},{"./BitArray":1,"./GifEncoderLZW":3}},{}],5:[function(require,module,exports){"use strict";var GifWriter=require("./GifWriter");module.exports=function e(t){var r,i,n,o;for(r=0,i=t.length;r<i;r++){if(!t[r])return!1}return!0};var GifFrame=function(e){this.width=e.width,this.height=e.height,this.data=new Uint8ClampedArray(e.width*e.height*4)};module.exports.GifFrame=GifFrame},{"./GifWriter":4}},{}],6:[function(require,module,exports){"use strict";var BitArray=require("./BitArray"),ByteArrayWriter=require("./GifWriter").ByteArrayWriter;module.exports=function(e,t){for(var r=new ByteArrayWriter,i=0;i<t.length;i++)r.writeByte(t[i]);return r.buffer}},{"./BitArray":1,"./GifWriter":4}},{}],7:[function(require,module,exports){"use strict";var Gif=require("./Gif");module.exports=function(e){this.options=e||{},this.frames=[],this.gif=null};var GifWorker=function(e){this.options=e||{},this.frames=[],this.gif=null};GifWorker.prototype.addFrame=function(e,t){var r=t||{};this.frames.push({data:e,options:r})},GifWorker.prototype.render=function(){if(!this.gif){var e=this.options;this.gif=new Gif({workers:1,quality:e.quality||10,width:e.width,height:e.height})}for(var t=0;t<this.frames.length;t++){this.gif.addFrame(this.frames[t].data,this.frames[t].options)}this.gif.render(),this.gif.on("finished",function(e){self.postMessage({type:"finished",data:e})})},module.exports=GifWorker},{"./Gif":8}},{}],8:[function(require,module,exports){"use strict";var BitArray=require("./BitArray"),GifEncoderLZW=require("./GifEncoderLZW"),ByteArrayWriter=require("./GifWriter").ByteArrayWriter;module.exports=function Gif(e){e=e||{},this.width=e.width||100,this.height=e.height||100,this.quality=e.quality||10;var t=new ByteArrayWriter;t.writeByte(71),t.writeByte(73),t.writeByte(70),t.writeByte(56),t.writeByte(57),t.writeByte(97);var r=new Uint8ClampedArray(256*3);for(var i=0;i<256;i++)r[3*i]=i,r[3*i+1]=i,r[3*i+2]=i;t.writeByte(this.width&255),t.writeByte(this.width>>8&255),t.writeByte(this.height&255),t.writeByte(this.height>>8&255),t.writeByte(240),t.writeByte(0),t.writeByte(0);for(var n=0;n<256*3;n++)t.writeByte(r[n]);this.buffer=t.buffer,this.frames=[],this.events={}};var GifGifClass=module.exports;GifGifClass.prototype.addFrame=function(e,t){var r=t||{};r.delay=r.delay||100,this.frames.push({data:e,delay:r.delay})},GifGifClass.prototype.on=function(e,t){this.events[e]=t},GifGifClass.prototype.render=function(){var e=new Gif({width:this.width,height:this.height});for(var t in this.frames){var r=this.frames[t];e.buffer=this.buffer;var i=new ByteArrayWriter;i.writeByte(33),i.writeByte(249),i.writeByte(4),i.writeByte(0),i.writeByte(r.delay&255),i.writeByte(r.delay>>8&255),i.writeByte(0),i.writeByte(0),i.writeByte(44),i.writeByte(0),i.writeByte(0),i.writeByte(0),i.writeByte(0),i.writeByte(this.width&255),i.writeByte(this.width>>8&255),i.writeByte(this.height&255),i.writeByte(this.height>>8&255),i.writeByte(0);var n=new Uint8ClampedArray(r.data.length);for(var o=0;o<r.data.length;o+=4){var a=Math.floor((r.data[o]+r.data[o+1]+r.data[o+2])/3),s=Math.floor(a/256);n[o/4]=s}var u=new BitArray(n.length);new GifEncoderLZW({img:n,dict:Object.create(null),clearCode:256,eoiCode:257,codeSize:9}).encode();var l=new ByteArrayWriter;l.writeBytes(u.toByteArray());for(var c=0;c<l.buffer.length;c+=255)l.buffer.slice(c,c+255).length>0&&(i.writeByte(Math.min(255,l.buffer.length-c)),i.writeBytes(l.buffer.slice(c,c+255)));i.writeByte(0),this.buffer=this.buffer.concat(i.buffer)}this.buffer.push(59),this.events.finished&&this.events.finished(new Blob([new Uint8Array(this.buffer)],{type:"image/gif"}))},module.exports=GifGifClass},{"./BitArray":1,"./GifEncoderLZW":3,"./GifWriter":4}},{}]},{},[7])(7)});
